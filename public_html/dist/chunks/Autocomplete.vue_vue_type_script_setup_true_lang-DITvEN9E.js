import{d as P,r as d,l as $,f as O,y as U,z as j,c as p,o as m,m as B,a as y,w as H,H as K,B as T,F as G,b as J,j as g,n as C,t as D}from"./runtime-dom.esm-bundler-CFjh9Irh.js";const Q={class:"relative w-full"},W=["name","value","required"],X={class:"input input-primary w-full flex items-center gap-2"},Y=["value","placeholder","disabled"],Z=["onClick"],ee=P({__name:"Autocomplete",props:{modelValue:{},options:{},placeholder:{default:""},acceptNewValue:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},name:{default:void 0},required:{type:Boolean,default:!1}},emits:["update:modelValue","select"],setup(r,{expose:z,emit:E}){const n=r,i=E,w=d(null),c=d(null),s=d(!1),t=d(-1),a=d(n.modelValue);$(()=>n.modelValue,e=>{a.value=e});const v=O(()=>a.value?n.options.filter(e=>L(e.value,a.value)):[]),I=O(()=>s.value&&(v.value.length>0||n.acceptNewValue&&a.value));function V(e){return e.toLowerCase().normalize("NFD").replace(/[-']/g," ").replace(/[\u0300-\u036f]/g,"")}function L(e,l){const u=V(e),o=V(l);if(u.includes(o))return!0;let f=0;const R=o.length>4?1:0;for(let h=0;h<o.length;h++)if(u[h]!==o[h]&&(f++,f>R))return!1;return!0}function S(e){const l=e.target;a.value=l.value,i("update:modelValue",l.value),s.value=!0,t.value=-1}function b(e){a.value=e.value,i("update:modelValue",e.value),i("select",e),s.value=!1,t.value=-1}function k(){if(n.acceptNewValue&&a.value){const e={value:a.value};i("select",e),s.value=!1,t.value=-1}}function q(e){const l=v.value,u=n.acceptNewValue&&a.value&&!l.some(f=>f.value===a.value),o=l.length+(u?1:0);o!==0&&(e.key==="ArrowDown"?(e.preventDefault(),e.stopImmediatePropagation(),t.value<o-1?t.value++:t.value=0,N()):e.key==="ArrowUp"?(e.preventDefault(),e.stopImmediatePropagation(),t.value>0?t.value--:t.value=o-1,N()):e.key==="Enter"?(e.preventDefault(),e.stopImmediatePropagation(),t.value>=0&&t.value<l.length?b(l[t.value]):u&&t.value===l.length&&k()):e.key==="Escape"&&(e.preventDefault(),a.value="",i("update:modelValue",""),s.value=!1,t.value=-1))}function N(){if(t.value<0||!c.value)return;const e=c.value.querySelectorAll("li");e[t.value]&&e[t.value].scrollIntoView({behavior:"smooth",block:"nearest"})}function F(){setTimeout(()=>{!n.acceptNewValue&&a.value&&(n.options.some(l=>l.value===a.value)||(a.value="",i("update:modelValue",""))),s.value=!1},200)}function x(e){const l=e.target;w.value&&!w.value.contains(l)&&c.value&&!c.value.contains(l)&&(s.value=!1)}function A(){var e;(e=w.value)==null||e.focus()}z({focus:A}),U(()=>{document.addEventListener("click",x)}),j(()=>{document.removeEventListener("click",x)});function M(e){return e.label||e.value}return(e,l)=>(m(),p("div",Q,[r.name?(m(),p("input",{key:0,type:"hidden",name:r.name,value:a.value,required:r.required},null,8,W)):B("",!0),y("label",X,[y("input",{ref_key:"inputRef",ref:w,type:"text",value:a.value,placeholder:r.placeholder,disabled:r.disabled,class:"grow bg-transparent outline-none",autocomplete:"off",onInput:S,onKeydown:q,onFocus:l[0]||(l[0]=u=>s.value=!0),onBlur:F},null,40,Y),K(e.$slots,"icon")]),H(y("ul",{ref_key:"listRef",ref:c,class:"autocomplete-list absolute w-full bg-white border border-primary mt-1 max-h-60 overflow-y-auto"},[(m(!0),p(G,null,J(v.value,(u,o)=>(m(),p("li",{key:u.value,class:C(["p-2 cursor-pointer hover:bg-primary hover:text-white",{"bg-primary text-white":o===t.value}]),onMousedown:l[1]||(l[1]=g(()=>{},["prevent"])),onClick:g(f=>b(u),["stop"])},D(M(u)),43,Z))),128)),r.acceptNewValue&&a.value&&!v.value.some(u=>u.value===a.value)?(m(),p("li",{key:0,class:C(["p-2 cursor-pointer hover:bg-primary hover:text-white",{"bg-primary text-white":t.value===v.value.length}]),onMousedown:l[2]||(l[2]=g(()=>{},["prevent"])),onClick:g(k,["stop"])},' "'+D(a.value)+'" ',35)):B("",!0)],512),[[T,I.value]])]))}});export{ee as _};
