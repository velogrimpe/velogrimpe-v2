import{d as R,r as d,l as I,f as N,N as _,O as U,c as m,o as p,m as O,a as x,w as $,P as K,F as M,b as P,n as C,t as D}from"./runtime-dom.esm-bundler-Cpy2cnzk.js";const T={class:"relative w-full"},j=["name","value","required"],G=["value","placeholder","disabled"],H=["onClick"],Q=R({__name:"Autocomplete",props:{modelValue:{},options:{},placeholder:{default:""},acceptNewValue:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},name:{default:void 0},required:{type:Boolean,default:!1}},emits:["update:modelValue","select"],setup(s,{emit:B}){const o=s,i=B,w=d(null),c=d(null),r=d(!1),a=d(-1),l=d(o.modelValue);I(()=>o.modelValue,e=>{l.value=e});const v=N(()=>l.value?o.options.filter(e=>E(e.value,l.value)):[]),z=N(()=>r.value&&(v.value.length>0||o.acceptNewValue&&l.value));function y(e){return e.toLowerCase().normalize("NFD").replace(/[-']/g," ").replace(/[\u0300-\u036f]/g,"")}function E(e,t){const u=y(e),n=y(t);if(u.includes(n))return!0;let f=0;const A=n.length>4?1:0;for(let h=0;h<n.length;h++)if(u[h]!==n[h]&&(f++,f>A))return!1;return!0}function L(e){const t=e.target;l.value=t.value,i("update:modelValue",t.value),r.value=!0,a.value=-1}function V(e){l.value=e.value,i("update:modelValue",e.value),i("select",e),r.value=!1,a.value=-1}function g(){if(o.acceptNewValue&&l.value){const e={value:l.value};i("select",e),r.value=!1,a.value=-1}}function q(e){const t=v.value,u=o.acceptNewValue&&l.value&&!t.some(f=>f.value===l.value),n=t.length+(u?1:0);e.key==="ArrowDown"?(e.preventDefault(),a.value=(a.value+1)%n,b()):e.key==="ArrowUp"?(e.preventDefault(),a.value=a.value<=0?n-1:a.value-1,b()):e.key==="Enter"?(e.preventDefault(),a.value>=0&&a.value<t.length?V(t[a.value]):u&&a.value===t.length&&g()):e.key==="Escape"&&(e.preventDefault(),l.value="",i("update:modelValue",""),r.value=!1,a.value=-1)}function b(){if(a.value<0||!c.value)return;const e=c.value.querySelectorAll("li");e[a.value]&&e[a.value].scrollIntoView({behavior:"smooth",block:"nearest"})}function F(){setTimeout(()=>{!o.acceptNewValue&&l.value&&(o.options.some(t=>t.value===l.value)||(l.value="",i("update:modelValue",""))),r.value=!1},200)}function k(e){const t=e.target;w.value&&!w.value.contains(t)&&c.value&&!c.value.contains(t)&&(r.value=!1)}_(()=>{document.addEventListener("click",k)}),U(()=>{document.removeEventListener("click",k)});function S(e){return e.label||e.value}return(e,t)=>(p(),m("div",T,[s.name?(p(),m("input",{key:0,type:"hidden",name:s.name,value:l.value,required:s.required},null,8,j)):O("",!0),x("input",{ref_key:"inputRef",ref:w,type:"search",value:l.value,placeholder:s.placeholder,disabled:s.disabled,class:"input input-primary w-full",autocomplete:"off",onInput:L,onKeydown:q,onFocus:t[0]||(t[0]=u=>r.value=!0),onBlur:F},null,40,G),$(x("ul",{ref_key:"listRef",ref:c,class:"autocomplete-list absolute w-full bg-white border border-primary mt-1 max-h-60 overflow-y-auto z-50"},[(p(!0),m(M,null,P(v.value,(u,n)=>(p(),m("li",{key:u.value,class:C(["p-2 cursor-pointer hover:bg-primary hover:text-white",{"bg-primary text-white":n===a.value}]),onClick:f=>V(u)},D(S(u)),11,H))),128)),s.acceptNewValue&&l.value&&!v.value.some(u=>u.value===l.value)?(p(),m("li",{key:0,class:C(["p-2 cursor-pointer hover:bg-primary hover:text-white",{"bg-primary text-white":a.value===v.value.length}]),onClick:g},' "'+D(l.value)+'" ',3)):O("",!0)],512),[[K,z.value]])]))}});export{Q as _};
