import{d as A,r as d,l as R,f as x,B as _,C as P,c as m,o as p,m as C,a as g,w as $,H as U,E as H,F as K,b as M,n as O,t as B}from"./runtime-dom.esm-bundler-CHpZyyPM.js";const T={class:"relative w-full"},j=["name","value","required"],G={class:"input input-primary w-full flex items-center gap-2"},J=["value","placeholder","disabled"],Q=["onClick"],X=A({__name:"Autocomplete",props:{modelValue:{},options:{},placeholder:{default:""},acceptNewValue:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},name:{default:void 0},required:{type:Boolean,default:!1}},emits:["update:modelValue","select"],setup(s,{emit:D}){const n=s,i=D,w=d(null),c=d(null),r=d(!1),l=d(-1),a=d(n.modelValue);R(()=>n.modelValue,e=>{a.value=e});const v=x(()=>a.value?n.options.filter(e=>I(e.value,a.value)):[]),E=x(()=>r.value&&(v.value.length>0||n.acceptNewValue&&a.value));function y(e){return e.toLowerCase().normalize("NFD").replace(/[-']/g," ").replace(/[\u0300-\u036f]/g,"")}function I(e,t){const u=y(e),o=y(t);if(u.includes(o))return!0;let f=0;const F=o.length>4?1:0;for(let h=0;h<o.length;h++)if(u[h]!==o[h]&&(f++,f>F))return!1;return!0}function L(e){const t=e.target;a.value=t.value,i("update:modelValue",t.value),r.value=!0,l.value=-1}function V(e){a.value=e.value,i("update:modelValue",e.value),i("select",e),r.value=!1,l.value=-1}function b(){if(n.acceptNewValue&&a.value){const e={value:a.value};i("select",e),r.value=!1,l.value=-1}}function S(e){const t=v.value,u=n.acceptNewValue&&a.value&&!t.some(f=>f.value===a.value),o=t.length+(u?1:0);o!==0&&(e.key==="ArrowDown"?(e.preventDefault(),e.stopImmediatePropagation(),l.value<o-1?l.value++:l.value=0,k()):e.key==="ArrowUp"?(e.preventDefault(),e.stopImmediatePropagation(),l.value>0?l.value--:l.value=o-1,k()):e.key==="Enter"?(e.preventDefault(),e.stopImmediatePropagation(),l.value>=0&&l.value<t.length?V(t[l.value]):u&&l.value===t.length&&b()):e.key==="Escape"&&(e.preventDefault(),a.value="",i("update:modelValue",""),r.value=!1,l.value=-1))}function k(){if(l.value<0||!c.value)return;const e=c.value.querySelectorAll("li");e[l.value]&&e[l.value].scrollIntoView({behavior:"smooth",block:"nearest"})}function q(){setTimeout(()=>{!n.acceptNewValue&&a.value&&(n.options.some(t=>t.value===a.value)||(a.value="",i("update:modelValue",""))),r.value=!1},200)}function N(e){const t=e.target;w.value&&!w.value.contains(t)&&c.value&&!c.value.contains(t)&&(r.value=!1)}_(()=>{document.addEventListener("click",N)}),P(()=>{document.removeEventListener("click",N)});function z(e){return e.label||e.value}return(e,t)=>(p(),m("div",T,[s.name?(p(),m("input",{key:0,type:"hidden",name:s.name,value:a.value,required:s.required},null,8,j)):C("",!0),g("div",G,[g("input",{ref_key:"inputRef",ref:w,type:"text",value:a.value,placeholder:s.placeholder,disabled:s.disabled,class:"grow bg-transparent outline-none",autocomplete:"off",onInput:L,onKeydown:S,onFocus:t[0]||(t[0]=u=>r.value=!0),onBlur:q},null,40,J),U(e.$slots,"icon")]),$(g("ul",{ref_key:"listRef",ref:c,class:"autocomplete-list absolute w-full bg-white border border-primary mt-1 max-h-60 overflow-y-auto"},[(p(!0),m(K,null,M(v.value,(u,o)=>(p(),m("li",{key:u.value,class:O(["p-2 cursor-pointer hover:bg-primary hover:text-white",{"bg-primary text-white":o===l.value}]),onClick:f=>V(u)},B(z(u)),11,Q))),128)),s.acceptNewValue&&a.value&&!v.value.some(u=>u.value===a.value)?(p(),m("li",{key:0,class:O(["p-2 cursor-pointer hover:bg-primary hover:text-white",{"bg-primary text-white":l.value===v.value.length}]),onClick:b},' "'+B(a.value)+'" ',3)):C("",!0)],512),[[H,E.value]])]))}});export{X as _};
