import{d as A,r as f,l as R,f as N,N as I,O as U,c as m,o as h,a as O,w as $,P as q,m as K,F as M,b as P,n as x,t as C}from"./runtime-dom.esm-bundler-Cpy2cnzk.js";const T={class:"relative w-full"},j=["value","placeholder","disabled"],G=["onClick"],J=A({__name:"Autocomplete",props:{modelValue:{},options:{},placeholder:{default:""},acceptNewValue:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","select"],setup(p,{emit:D}){const n=p,r=D,w=f(null),i=f(null),s=f(!1),l=f(-1),a=f(n.modelValue);R(()=>n.modelValue,e=>{a.value=e});const c=N(()=>a.value?n.options.filter(e=>z(e.value,a.value)):[]),_=N(()=>s.value&&(c.value.length>0||n.acceptNewValue&&a.value));function V(e){return e.toLowerCase().normalize("NFD").replace(/[-']/g," ").replace(/[\u0300-\u036f]/g,"")}function z(e,t){const u=V(e),o=V(t);if(u.includes(o))return!0;let v=0;const S=o.length>4?1:0;for(let d=0;d<o.length;d++)if(u[d]!==o[d]&&(v++,v>S))return!1;return!0}function B(e){const t=e.target;a.value=t.value,r("update:modelValue",t.value),s.value=!0,l.value=-1}function g(e){a.value=e.value,r("update:modelValue",e.value),r("select",e),s.value=!1,l.value=-1}function y(){if(n.acceptNewValue&&a.value){const e={value:a.value};r("select",e),s.value=!1,l.value=-1}}function E(e){const t=c.value,u=n.acceptNewValue&&a.value&&!t.some(v=>v.value===a.value),o=t.length+(u?1:0);e.key==="ArrowDown"?(e.preventDefault(),l.value=(l.value+1)%o,b()):e.key==="ArrowUp"?(e.preventDefault(),l.value=l.value<=0?o-1:l.value-1,b()):e.key==="Enter"?(e.preventDefault(),l.value>=0&&l.value<t.length?g(t[l.value]):u&&l.value===t.length&&y()):e.key==="Escape"&&(e.preventDefault(),a.value="",r("update:modelValue",""),s.value=!1,l.value=-1)}function b(){if(l.value<0||!i.value)return;const e=i.value.querySelectorAll("li");e[l.value]&&e[l.value].scrollIntoView({behavior:"smooth",block:"nearest"})}function L(){setTimeout(()=>{!n.acceptNewValue&&a.value&&(n.options.some(t=>t.value===a.value)||(a.value="",r("update:modelValue",""))),s.value=!1},200)}function k(e){const t=e.target;w.value&&!w.value.contains(t)&&i.value&&!i.value.contains(t)&&(s.value=!1)}I(()=>{document.addEventListener("click",k)}),U(()=>{document.removeEventListener("click",k)});function F(e){return e.label||e.value}return(e,t)=>(h(),m("div",T,[O("input",{ref_key:"inputRef",ref:w,type:"search",value:a.value,placeholder:p.placeholder,disabled:p.disabled,class:"input input-primary w-full",autocomplete:"off",onInput:B,onKeydown:E,onFocus:t[0]||(t[0]=u=>s.value=!0),onBlur:L},null,40,j),$(O("ul",{ref_key:"listRef",ref:i,class:"autocomplete-list absolute w-full bg-white border border-primary mt-1 max-h-60 overflow-y-auto z-50"},[(h(!0),m(M,null,P(c.value,(u,o)=>(h(),m("li",{key:u.value,class:x(["p-2 cursor-pointer hover:bg-primary hover:text-white",{"bg-primary text-white":o===l.value}]),onClick:v=>g(u)},C(F(u)),11,G))),128)),p.acceptNewValue&&a.value&&!c.value.some(u=>u.value===a.value)?(h(),m("li",{key:0,class:x(["p-2 cursor-pointer hover:bg-primary hover:text-white",{"bg-primary text-white":l.value===c.value.length}]),onClick:y},' "'+C(a.value)+'" ',3)):K("",!0)],512),[[q,_.value]])]))}});export{J as _};
