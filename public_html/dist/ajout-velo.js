import{k as h,r as u,x as l}from"./chunks/runtime-dom.esm-bundler-DMen96Nq.js";import{_ as I}from"./chunks/FormAutocomplete.vue_vue_type_script_setup_true_lang-DfPzlzJ2.js";import"./chunks/Autocomplete.vue_vue_type_script_setup_true_lang-XJhyqp0n.js";const E=()=>({icon:()=>l("svg",{class:"w-4 h-4 fill-none stroke-current shrink-0"},[l("use",{href:"#search"})])});document.addEventListener("DOMContentLoaded",()=>{const n=document.getElementById("vue-ajout-velo");if(!n){console.warn("[velogrimpe] #vue-ajout-velo mount point not found");return}let m=[],f=[],v=null,p=null;try{m=JSON.parse(n.dataset.gares||"[]"),f=JSON.parse(n.dataset.falaises||"[]"),v=n.dataset.presetFalaiseId?parseInt(n.dataset.presetFalaiseId,10):null,p=n.dataset.presetGareId?parseInt(n.dataset.presetGareId,10):null}catch(i){console.error("[velogrimpe] Failed to parse ajout-velo data:",i)}const g=(i,c)=>{if(!i||!c){const o=document.getElementById("itineraireExistsAlert");o&&o.classList.add("hidden");return}fetch(`/api/verify_velo_dup.php?gare_id=${i}&falaise_id=${c}`).then(o=>o.json()).then(o=>{const d=document.getElementById("itineraireExistsAlert");d&&(o?d.classList.remove("hidden"):d.classList.add("hidden"))})};h({setup(){const i=u(""),c=u(!1),o=u(""),d=u(!1);if(p){const t=m.find(e=>e.id===p);t&&(i.value=t.nom,c.value=!0,setTimeout(()=>{const e=document.getElementById("gare_id"),a=document.getElementById("velo_depart");e&&(e.value=String(t.id)),a&&(a.value=t.nomformate)},0))}if(v){const t=f.find(e=>e.id===v);t&&(o.value=t.nom,d.value=!0,setTimeout(()=>{const e=document.getElementById("falaise_id"),a=document.getElementById("velo_arrivee");e&&(e.value=String(t.id)),a&&(a.value=t.nomformate)},0))}const _=t=>{const e=t,a=document.getElementById("gare_id"),s=document.getElementById("velo_depart"),r=document.getElementById("falaise_id");e?(a&&(a.value=String(e.id)),s&&(s.value=e.nomformate||""),g(e.id,(r==null?void 0:r.value)||"")):(a&&(a.value=""),s&&(s.value=""))},y=t=>{const e=t,a=document.getElementById("falaise_id"),s=document.getElementById("velo_arrivee"),r=document.getElementById("gare_id");e?(a&&(a.value=String(e.id)),s&&(s.value=e.nomformate||""),g((r==null?void 0:r.value)||"",e.id)):(a&&(a.value=""),s&&(s.value=""))};return()=>l("div",{class:"flex flex-col md:flex-row gap-4 md:items-center flex-1"},[l("div",{class:"flex flex-col gap-1 grow"},[l("div",{class:"relative not-prose"},[l("label",{class:"form-control",for:"gare_nom"},[l("b",null,"Gare de départ de l'itinéraire vélo :"),l(I,{modelValue:i.value,"onUpdate:modelValue":t=>{i.value=t},items:m,disabled:c.value,onSelect:_},E())])])]),l("div",{class:"flex flex-col gap-1 grow"},[l("div",{class:"relative not-prose"},[l("label",{class:"form-control",for:"falaise_nom"},[l("b",null,"Falaise d'arrivée de l'itinéraire vélo :"),l(I,{modelValue:o.value,"onUpdate:modelValue":t=>{o.value=t},items:f,disabled:d.value,onSelect:y},E())])])])])}}).mount(n),console.log("[velogrimpe] Vue ajout-velo autocomplete mounted")});
