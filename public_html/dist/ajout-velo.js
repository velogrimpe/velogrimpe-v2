import{k as I,r as f,M as a}from"./chunks/runtime-dom.esm-bundler-Cpy2cnzk.js";import{_ as g}from"./chunks/FormAutocomplete.vue_vue_type_script_setup_true_lang-DB7AKhia.js";import"./chunks/Autocomplete.vue_vue_type_script_setup_true_lang-DdIgG3--.js";document.addEventListener("DOMContentLoaded",()=>{const r=document.getElementById("vue-ajout-velo");if(!r){console.warn("[velogrimpe] #vue-ajout-velo mount point not found");return}let v=[],m=[],u=null;try{v=JSON.parse(r.dataset.gares||"[]"),m=JSON.parse(r.dataset.falaises||"[]"),u=r.dataset.presetFalaiseId?parseInt(r.dataset.presetFalaiseId,10):null}catch(s){console.error("[velogrimpe] Failed to parse ajout-velo data:",s)}const p=(s,d)=>{if(!s||!d){const o=document.getElementById("itineraireExistsAlert");o&&o.classList.add("hidden");return}fetch(`/api/verify_velo_dup.php?gare_id=${s}&falaise_id=${d}`).then(o=>o.json()).then(o=>{const c=document.getElementById("itineraireExistsAlert");c&&(o?c.classList.remove("hidden"):c.classList.add("hidden"))})};I({setup(){const s=f(""),d=f(""),o=f(!1);if(u){const t=m.find(e=>e.id===u);t&&(d.value=t.nom,o.value=!0,setTimeout(()=>{const e=document.getElementById("falaise_id"),l=document.getElementById("velo_arrivee");e&&(e.value=String(t.id)),l&&(l.value=t.nomformate)},0))}const c=t=>{const e=t,l=document.getElementById("gare_id"),i=document.getElementById("velo_depart"),n=document.getElementById("falaise_id");e?(l&&(l.value=String(e.id)),i&&(i.value=e.nomformate||""),p(e.id,(n==null?void 0:n.value)||"")):(l&&(l.value=""),i&&(i.value=""))},E=t=>{const e=t,l=document.getElementById("falaise_id"),i=document.getElementById("velo_arrivee"),n=document.getElementById("gare_id");e?(l&&(l.value=String(e.id)),i&&(i.value=e.nomformate||""),p((n==null?void 0:n.value)||"",e.id)):(l&&(l.value=""),i&&(i.value=""))};return()=>a("div",{class:"flex flex-col md:flex-row gap-4 md:items-center flex-1"},[a("div",{class:"flex flex-col gap-1 grow"},[a("div",{class:"relative not-prose"},[a("label",{class:"form-control",for:"gare_nom"},[a("b",null,"Gare de départ de l'itinéraire vélo :"),a(g,{modelValue:s.value,"onUpdate:modelValue":t=>{s.value=t},items:v,onSelect:c})])])]),a("div",{class:"flex flex-col gap-1 grow"},[a("div",{class:"relative not-prose"},[a("label",{class:"form-control",for:"falaise_nom"},[a("b",null,"Falaise d'arrivée de l'itinéraire vélo :"),a(g,{modelValue:d.value,"onUpdate:modelValue":t=>{d.value=t},items:m,disabled:o.value,onSelect:E})])])])])}}).mount(r),console.log("[velogrimpe] Vue ajout-velo autocomplete mounted")});
