import{k as y,r as c,M as l}from"./chunks/runtime-dom.esm-bundler-Cpy2cnzk.js";import{_ as E}from"./chunks/FormAutocomplete.vue_vue_type_script_setup_true_lang-1__GtXz4.js";import"./chunks/Autocomplete.vue_vue_type_script_setup_true_lang-B97YQDHO.js";document.addEventListener("DOMContentLoaded",()=>{const s=document.getElementById("vue-ajout-velo");if(!s){console.warn("[velogrimpe] #vue-ajout-velo mount point not found");return}let m=[],f=[],v=null,p=null;try{m=JSON.parse(s.dataset.gares||"[]"),f=JSON.parse(s.dataset.falaises||"[]"),v=s.dataset.presetFalaiseId?parseInt(s.dataset.presetFalaiseId,10):null,p=s.dataset.presetGareId?parseInt(s.dataset.presetGareId,10):null}catch(n){console.error("[velogrimpe] Failed to parse ajout-velo data:",n)}const g=(n,u)=>{if(!n||!u){const o=document.getElementById("itineraireExistsAlert");o&&o.classList.add("hidden");return}fetch(`/api/verify_velo_dup.php?gare_id=${n}&falaise_id=${u}`).then(o=>o.json()).then(o=>{const d=document.getElementById("itineraireExistsAlert");d&&(o?d.classList.remove("hidden"):d.classList.add("hidden"))})};y({setup(){const n=c(""),u=c(!1),o=c(""),d=c(!1);if(p){const t=m.find(e=>e.id===p);t&&(n.value=t.nom,u.value=!0,setTimeout(()=>{const e=document.getElementById("gare_id"),a=document.getElementById("velo_depart");e&&(e.value=String(t.id)),a&&(a.value=t.nomformate)},0))}if(v){const t=f.find(e=>e.id===v);t&&(o.value=t.nom,d.value=!0,setTimeout(()=>{const e=document.getElementById("falaise_id"),a=document.getElementById("velo_arrivee");e&&(e.value=String(t.id)),a&&(a.value=t.nomformate)},0))}const I=t=>{const e=t,a=document.getElementById("gare_id"),i=document.getElementById("velo_depart"),r=document.getElementById("falaise_id");e?(a&&(a.value=String(e.id)),i&&(i.value=e.nomformate||""),g(e.id,(r==null?void 0:r.value)||"")):(a&&(a.value=""),i&&(i.value=""))},_=t=>{const e=t,a=document.getElementById("falaise_id"),i=document.getElementById("velo_arrivee"),r=document.getElementById("gare_id");e?(a&&(a.value=String(e.id)),i&&(i.value=e.nomformate||""),g((r==null?void 0:r.value)||"",e.id)):(a&&(a.value=""),i&&(i.value=""))};return()=>l("div",{class:"flex flex-col md:flex-row gap-4 md:items-center flex-1"},[l("div",{class:"flex flex-col gap-1 grow"},[l("div",{class:"relative not-prose"},[l("label",{class:"form-control",for:"gare_nom"},[l("b",null,"Gare de départ de l'itinéraire vélo :"),l(E,{modelValue:n.value,"onUpdate:modelValue":t=>{n.value=t},items:m,disabled:u.value,onSelect:I})])])]),l("div",{class:"flex flex-col gap-1 grow"},[l("div",{class:"relative not-prose"},[l("label",{class:"form-control",for:"falaise_nom"},[l("b",null,"Falaise d'arrivée de l'itinéraire vélo :"),l(E,{modelValue:o.value,"onUpdate:modelValue":t=>{o.value=t},items:f,disabled:d.value,onSelect:_})])])])])}}).mount(s),console.log("[velogrimpe] Vue ajout-velo autocomplete mounted")});
