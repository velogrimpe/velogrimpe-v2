import{r as b,f as d,l as B,d as D,c as a,o as t,m as k,a as l,t as n,u as m,F as S,b as C,n as E,e as w,k as G}from"./chunks/runtime-dom.esm-bundler-CvJMXt7Z.js";import{d as H,c as M}from"./chunks/pinia-CVUtMy5_.js";import{f as I,c as L}from"./chunks/time-BTxH6nDj.js";import{_ as P}from"./chunks/_plugin-vue_export-helper-DlAUqK2U.js";const V=H("carte",()=>{const r=b(null),s=b(0),o=b(0),f=["indianRed","tomato","teal","paleVioletRed","mediumSlateBlue","lightSalmon","fireBrick","crimson","purple","hotPink","mediumOrchid"],i=d(()=>r.value?r.value.type:null),v=d(()=>i.value==="falaise"||i.value==="falaise_hors_topo"),u=d(()=>i.value==="gare"||i.value==="gare_hors_topo"),_=d(()=>s.value!==o.value);function x(e){r.value=e}function y(){r.value=null}function p(e,h){s.value=e,o.value=h}function c(e){return f[e%f.length]}return B(r,e=>{window.dispatchEvent(new CustomEvent("velogrimpe:selection",{detail:e?{type:e.type,id:"falaise_id"in e?e.falaise_id:e.gare_id}:null}))}),{selected:r,totalFalaises:s,filteredFalaises:o,itinerairesColors:f,selectedType:i,isFalaiseSelected:v,isGareSelected:u,hasFiltersApplied:_,setSelected:x,clearSelected:y,updateStats:p,getColorForIndex:c}}),q={key:0,class:"flex gap-1 items-center justify-center font-bold text-primary border-b border-base-300 pb-1 mb-1"},A={key:0},N={key:1},$={key:1,class:"flex flex-col gap-1 items-center text-center"},j={key:2,class:"flex flex-col gap-1"},z={class:"flex flex-col md:flex-row justify-between items-center gap-4"},O={class:"text-xl font-bold"},R=["href"],J=["href"],K=["innerHTML"],Q=["innerHTML"],U={key:0},W={key:3,class:"flex flex-col gap-1"},X={class:"text-xl font-bold"},Y=["href"],Z="/symbols/icons.svg#ri-filter-line",ee=D({__name:"InfoPanel",setup(r){const s=V(),o=d(()=>s.selected),f=d(()=>s.isFalaiseSelected),i=d(()=>s.isGareSelected),v=d(()=>s.hasFiltersApplied),u=d(()=>f.value?o.value:null),_=d(()=>i.value?o.value:null);function x(p){return s.getColorForIndex(p)}function y(p){return p?p.replace(/\n/g,"<br>"):""}return(p,c)=>(t(),a("div",null,[o.value?k("",!0):(t(),a("div",q,[l("svg",{class:"w-4 h-4 fill-current"},[l("use",{href:Z})]),v.value?(t(),a("span",A,n(m(s).filteredFalaises)+" falaises correspondent aux filtres ",1)):(t(),a("span",N,n(m(s).totalFalaises)+" falaises ",1))])),o.value?u.value?(t(),a("div",j,[l("div",z,[l("h3",O,[l("a",{href:`/falaise.php?falaise_id=${u.value.falaise_id}`},n(u.value.falaise_nom),9,R)]),l("a",{class:"btn btn-primary btn-xs text-base-100! hover:text-base-100!",href:`/falaise.php?falaise_id=${u.value.falaise_id}`}," Voir la fiche falaise ",8,J)]),u.value.falaise_fermee?(t(),a("p",{key:0,class:"text-wrap text-error",innerHTML:y(u.value.falaise_fermee)},null,8,K)):(t(),a("p",{key:1,class:"text-wrap",innerHTML:y(u.value.falaise_voletcarto)},null,8,Q)),l("details",null,[c[1]||(c[1]=l("summary",null,[l("i",null,"Liste des accès")],-1)),l("ul",null,[(t(!0),a(S,null,C(u.value.access,(e,h)=>{var g;return t(),a("li",{key:e.velo_id,class:"relative ml-8"},[l("div",{class:E(["absolute top-[6px] -left-2 w-6 h-1 -translate-x-full",x(h)])},null,2),l("div",null,[l("b",null,n((g=e.gare)==null?void 0:g.gare_nom)+" ("+n(m(I)(m(L)(e)))+")",1),w(" : "+n(e.velo_km)+" km, "+n(e.velo_dplus)+" D+ ",1),e.velo_apieduniquement==="1"?(t(),a("span",U," (à pied)")):k("",!0)])])}),128))])])])):_.value?(t(),a("div",W,[l("h3",X,"Gare de "+n(_.value.gare_nom),1),l("details",null,[c[3]||(c[3]=l("summary",null,[l("i",null,"Falaises accessibles depuis la gare")],-1)),l("ul",null,[(t(!0),a(S,null,C(_.value.access,(e,h)=>{var g,F;return t(),a("li",{key:e.velo_id,class:"relative ml-8"},[l("div",{class:E(["absolute top-2 -left-2 w-6 h-1 -translate-x-full",x(h)])},null,2),l("div",null,[l("a",{class:"link",href:`/falaise.php?falaise_id=${(g=e.falaise)==null?void 0:g.falaise_id}`},n((F=e.falaise)==null?void 0:F.falaise_nom),9,Y),c[2]||(c[2]=w(" : ",-1)),l("b",null,n(m(I)(m(L)(e))),1),w(" "+n(e.velo_apieduniquement==="1"?"à pied":"à vélo")+" ("+n(e.velo_km)+" km, "+n(e.velo_dplus)+" D+). ",1)])])}),128))])])])):k("",!0):(t(),a("div",$,[...c[0]||(c[0]=[l("div",null,"Cliquez sur une falaise pour voir ses informations",-1)])]))]))}}),le=P(ee,[["__scopeId","data-v-039864e7"]]);function T(){const r=document.getElementById("vue-info-panel");if(!r){console.warn("[velogrimpe] #vue-info-panel mount point not found");return}const s=G(le),o=M();s.use(o);const f=V(o);window.velogrimpe=window.velogrimpe||{},window.velogrimpe.carteInfo={setSelected:i=>{f.setSelected(i)},clearSelected:()=>{f.clearSelected()},updateStats:(i,v)=>{f.updateStats(i,v)}},s.mount(r),console.log("[velogrimpe] Vue info panel mounted"),window.dispatchEvent(new CustomEvent("velogrimpe:info-ready"))}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",T):T();
