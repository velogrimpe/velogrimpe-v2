import{r as b,f,l as B,d as D,c as a,o,m as k,a as l,t as r,u as m,F as S,b as C,n as E,e as w,k as G}from"./chunks/runtime-dom.esm-bundler-CvJMXt7Z.js";import{d as M,c as H}from"./chunks/pinia-CVUtMy5_.js";import P from"/symbols/icons.svg";import{f as L,c as T}from"./chunks/time-BTxH6nDj.js";const V=M("carte",()=>{const n=b(null),s=b(0),t=b(0),d=["indianRed","tomato","teal","paleVioletRed","mediumSlateBlue","lightSalmon","fireBrick","crimson","purple","hotPink","mediumOrchid"],i=f(()=>n.value?n.value.type:null),v=f(()=>i.value==="falaise"||i.value==="falaise_hors_topo"),c=f(()=>i.value==="gare"||i.value==="gare_hors_topo"),_=f(()=>s.value!==t.value);function x(e){n.value=e}function y(){n.value=null}function p(e,h){s.value=e,t.value=h}function u(e){return d[e%d.length]}return B(n,e=>{window.dispatchEvent(new CustomEvent("velogrimpe:selection",{detail:e?{type:e.type,id:"falaise_id"in e?e.falaise_id:e.gare_id}:null}))}),{selected:n,totalFalaises:s,filteredFalaises:t,itinerairesColors:d,selectedType:i,isFalaiseSelected:v,isGareSelected:c,hasFiltersApplied:_,setSelected:x,clearSelected:y,updateStats:p,getColorForIndex:u}}),q=P+"#ri-filter-line",A={class:"info-panel bg-base-100 rounded-lg shadow-lg p-3 text-sm max-h-[300px] overflow-y-auto"},N={key:0,class:"flex gap-1 items-center justify-center font-bold text-primary border-b border-base-300 pb-1 mb-1"},O={key:0},$={key:1},j={key:1,class:"flex flex-col gap-1 items-center text-center"},z={key:2,class:"flex flex-col gap-1"},R={class:"flex flex-col md:flex-row justify-between items-center gap-4"},J={class:"text-xl font-bold"},K=["href"],Q=["href"],U=["innerHTML"],W=["innerHTML"],X={key:0},Y={key:3,class:"flex flex-col gap-1"},Z={class:"text-xl font-bold"},ee=["href"],le=D({__name:"InfoPanel",setup(n){const s=V(),t=f(()=>s.selected),d=f(()=>s.isFalaiseSelected),i=f(()=>s.isGareSelected),v=f(()=>s.hasFiltersApplied),c=f(()=>d.value?t.value:null),_=f(()=>i.value?t.value:null);function x(p){return s.getColorForIndex(p)}function y(p){return p?p.replace(/\n/g,"<br>"):""}return(p,u)=>(o(),a("div",A,[t.value?k("",!0):(o(),a("div",N,[u[0]||(u[0]=l("svg",{class:"w-4 h-4 fill-current"},[l("use",{"xlink:href":q})],-1)),v.value?(o(),a("span",O,r(m(s).filteredFalaises)+" falaises correspondent aux filtres ",1)):(o(),a("span",$,r(m(s).totalFalaises)+" falaises ",1))])),t.value?c.value?(o(),a("div",z,[l("div",R,[l("h3",J,[l("a",{href:`/falaise.php?falaise_id=${c.value.falaise_id}`},r(c.value.falaise_nom),9,K)]),l("a",{class:"btn btn-primary btn-xs text-base-100! hover:text-base-100!",href:`/falaise.php?falaise_id=${c.value.falaise_id}`}," Voir la fiche falaise ",8,Q)]),c.value.falaise_fermee?(o(),a("p",{key:0,class:"text-wrap text-error",innerHTML:y(c.value.falaise_fermee)},null,8,U)):(o(),a("p",{key:1,class:"text-wrap",innerHTML:y(c.value.falaise_voletcarto)},null,8,W)),l("details",null,[u[2]||(u[2]=l("summary",null,[l("i",null,"Liste des accès")],-1)),l("ul",null,[(o(!0),a(S,null,C(c.value.access,(e,h)=>{var g;return o(),a("li",{key:e.velo_id,class:"relative ml-8"},[l("div",{class:E(["absolute top-[6px] -left-2 w-6 h-1 -translate-x-full",x(h)])},null,2),l("div",null,[l("b",null,r((g=e.gare)==null?void 0:g.gare_nom)+" ("+r(m(L)(m(T)(e)))+")",1),w(" : "+r(e.velo_km)+" km, "+r(e.velo_dplus)+" D+ ",1),e.velo_apieduniquement==="1"?(o(),a("span",X," (à pied)")):k("",!0)])])}),128))])])])):_.value?(o(),a("div",Y,[l("h3",Z,"Gare de "+r(_.value.gare_nom),1),l("details",null,[u[4]||(u[4]=l("summary",null,[l("i",null,"Falaises accessibles depuis la gare")],-1)),l("ul",null,[(o(!0),a(S,null,C(_.value.access,(e,h)=>{var g,F;return o(),a("li",{key:e.velo_id,class:"relative ml-8"},[l("div",{class:E(["absolute top-2 -left-2 w-6 h-1 -translate-x-full",x(h)])},null,2),l("div",null,[l("a",{class:"link",href:`/falaise.php?falaise_id=${(g=e.falaise)==null?void 0:g.falaise_id}`},r((F=e.falaise)==null?void 0:F.falaise_nom),9,ee),u[3]||(u[3]=w(" : ",-1)),l("b",null,r(m(L)(m(T)(e))),1),w(" "+r(e.velo_apieduniquement==="1"?"à pied":"à vélo")+" ("+r(e.velo_km)+" km, "+r(e.velo_dplus)+" D+). ",1)])])}),128))])])])):k("",!0):(o(),a("div",j,[...u[1]||(u[1]=[l("div",null,"Cliquez sur une falaise pour voir ses informations",-1)])]))]))}}),se=(n,s)=>{const t=n.__vccOpts||n;for(const[d,i]of s)t[d]=i;return t},te=se(le,[["__scopeId","data-v-31e40b28"]]);function I(){const n=document.getElementById("vue-info-panel");if(!n){console.warn("[velogrimpe] #vue-info-panel mount point not found");return}const s=G(te),t=H();s.use(t);const d=V(t);window.velogrimpe=window.velogrimpe||{},window.velogrimpe.carteInfo={setSelected:i=>{d.setSelected(i)},clearSelected:()=>{d.clearSelected()},updateStats:(i,v)=>{d.updateStats(i,v)}},s.mount(n),console.log("[velogrimpe] Vue info panel mounted"),window.dispatchEvent(new CustomEvent("velogrimpe:info-ready"))}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",I):I();
