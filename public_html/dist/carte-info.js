import{r as b,f,l as B,d as D,c as t,o as n,m as k,a as l,t as r,u as v,F as S,b as C,n as E,e as w,k as G}from"./chunks/runtime-dom.esm-bundler-CvJMXt7Z.js";import{d as H,c as M}from"./chunks/pinia-CVUtMy5_.js";import{f as I,c as L}from"./chunks/time-BTxH6nDj.js";const V=H("carte",()=>{const o=b(null),s=b(0),a=b(0),u=["indianRed","tomato","teal","paleVioletRed","mediumSlateBlue","lightSalmon","fireBrick","crimson","purple","hotPink","mediumOrchid"],i=f(()=>o.value?o.value.type:null),m=f(()=>i.value==="falaise"||i.value==="falaise_hors_topo"),c=f(()=>i.value==="gare"||i.value==="gare_hors_topo"),_=f(()=>s.value!==a.value);function x(e){o.value=e}function y(){o.value=null}function p(e,h){s.value=e,a.value=h}function d(e){return u[e%u.length]}return B(o,e=>{window.dispatchEvent(new CustomEvent("velogrimpe:selection",{detail:e?{type:e.type,id:"falaise_id"in e?e.falaise_id:e.gare_id}:null}))}),{selected:o,totalFalaises:s,filteredFalaises:a,itinerairesColors:u,selectedType:i,isFalaiseSelected:m,isGareSelected:c,hasFiltersApplied:_,setSelected:x,clearSelected:y,updateStats:p,getColorForIndex:d}}),P={key:0,class:"flex gap-1 items-center justify-center font-bold text-primary border-b border-base-300 pb-1 mb-1"},q={key:0},A={key:1},N={key:1,class:"flex flex-col gap-1 items-center text-center"},O={key:2,class:"flex flex-col gap-1"},$={class:"flex flex-col md:flex-row justify-between items-center gap-4"},j={class:"text-xl font-bold"},z=["href"],R=["href"],J=["innerHTML"],K=["innerHTML"],Q={key:0},U={key:3,class:"flex flex-col gap-1"},W={class:"text-xl font-bold"},X=["href"],Y="/symbols/icons.svg#ri-filter-line",Z=D({__name:"InfoPanel",setup(o){const s=V(),a=f(()=>s.selected),u=f(()=>s.isFalaiseSelected),i=f(()=>s.isGareSelected),m=f(()=>s.hasFiltersApplied),c=f(()=>u.value?a.value:null),_=f(()=>i.value?a.value:null);function x(p){return s.getColorForIndex(p)}function y(p){return p?p.replace(/\n/g,"<br>"):""}return(p,d)=>(n(),t("div",null,[a.value?k("",!0):(n(),t("div",P,[l("svg",{class:"w-4 h-4 fill-current"},[l("use",{href:Y})]),m.value?(n(),t("span",q,r(v(s).filteredFalaises)+" falaises correspondent aux filtres ",1)):(n(),t("span",A,r(v(s).totalFalaises)+" falaises ",1))])),a.value?c.value?(n(),t("div",O,[l("div",$,[l("h3",j,[l("a",{href:`/falaise.php?falaise_id=${c.value.falaise_id}`},r(c.value.falaise_nom),9,z)]),l("a",{class:"btn btn-primary btn-xs text-base-100! hover:text-base-100!",href:`/falaise.php?falaise_id=${c.value.falaise_id}`}," Voir la fiche falaise ",8,R)]),c.value.falaise_fermee?(n(),t("p",{key:0,class:"text-wrap text-error",innerHTML:y(c.value.falaise_fermee)},null,8,J)):(n(),t("p",{key:1,class:"text-wrap",innerHTML:y(c.value.falaise_voletcarto)},null,8,K)),l("details",null,[d[1]||(d[1]=l("summary",null,[l("i",null,"Liste des accès")],-1)),l("ul",null,[(n(!0),t(S,null,C(c.value.access,(e,h)=>{var g;return n(),t("li",{key:e.velo_id,class:"relative ml-8"},[l("div",{class:E(["absolute top-[6px] -left-2 w-6 h-1 -translate-x-full",x(h)])},null,2),l("div",null,[l("b",null,r((g=e.gare)==null?void 0:g.gare_nom)+" ("+r(v(I)(v(L)(e)))+")",1),w(" : "+r(e.velo_km)+" km, "+r(e.velo_dplus)+" D+ ",1),e.velo_apieduniquement==="1"?(n(),t("span",Q," (à pied)")):k("",!0)])])}),128))])])])):_.value?(n(),t("div",U,[l("h3",W,"Gare de "+r(_.value.gare_nom),1),l("details",null,[d[3]||(d[3]=l("summary",null,[l("i",null,"Falaises accessibles depuis la gare")],-1)),l("ul",null,[(n(!0),t(S,null,C(_.value.access,(e,h)=>{var g,F;return n(),t("li",{key:e.velo_id,class:"relative ml-8"},[l("div",{class:E(["absolute top-2 -left-2 w-6 h-1 -translate-x-full",x(h)])},null,2),l("div",null,[l("a",{class:"link",href:`/falaise.php?falaise_id=${(g=e.falaise)==null?void 0:g.falaise_id}`},r((F=e.falaise)==null?void 0:F.falaise_nom),9,X),d[2]||(d[2]=w(" : ",-1)),l("b",null,r(v(I)(v(L)(e))),1),w(" "+r(e.velo_apieduniquement==="1"?"à pied":"à vélo")+" ("+r(e.velo_km)+" km, "+r(e.velo_dplus)+" D+). ",1)])])}),128))])])])):k("",!0):(n(),t("div",N,[...d[0]||(d[0]=[l("div",null,"Cliquez sur une falaise pour voir ses informations",-1)])]))]))}}),ee=(o,s)=>{const a=o.__vccOpts||o;for(const[u,i]of s)a[u]=i;return a},le=ee(Z,[["__scopeId","data-v-039864e7"]]);function T(){const o=document.getElementById("vue-info-panel");if(!o){console.warn("[velogrimpe] #vue-info-panel mount point not found");return}const s=G(le),a=M();s.use(a);const u=V(a);window.velogrimpe=window.velogrimpe||{},window.velogrimpe.carteInfo={setSelected:i=>{u.setSelected(i)},clearSelected:()=>{u.clearSelected()},updateStats:(i,m)=>{u.updateStats(i,m)}},s.mount(o),console.log("[velogrimpe] Vue info panel mounted"),window.dispatchEvent(new CustomEvent("velogrimpe:info-ready"))}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",T):T();
