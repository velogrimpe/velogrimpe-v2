import{r as b,f as d,l as B,d as D,c as s,o as t,m as k,i as G,t as n,u as m,a as l,F as S,b as C,n as E,e as w,k as M}from"./chunks/runtime-dom.esm-bundler-CHpZyyPM.js";import{d as H,c as N}from"./chunks/pinia-BLSXoc2I.js";import{f as L,c as T}from"./chunks/time-BTxH6nDj.js";import{_ as P}from"./chunks/Icon.vue_vue_type_script_setup_true_lang-Dfo531fH.js";import{_ as $}from"./chunks/_plugin-vue_export-helper-DlAUqK2U.js";const I=H("carte",()=>{const r=b(null),a=b(0),o=b(0),f=["indianRed","tomato","teal","paleVioletRed","mediumSlateBlue","lightSalmon","fireBrick","crimson","purple","hotPink","mediumOrchid"],i=d(()=>r.value?r.value.type:null),v=d(()=>i.value==="falaise"||i.value==="falaise_hors_topo"),u=d(()=>i.value==="gare"||i.value==="gare_hors_topo"),_=d(()=>a.value!==o.value);function x(e){r.value=e}function y(){r.value=null}function p(e,h){a.value=e,o.value=h}function c(e){return f[e%f.length]}return B(r,e=>{window.dispatchEvent(new CustomEvent("velogrimpe:selection",{detail:e?{type:e.type,id:"falaise_id"in e?e.falaise_id:e.gare_id}:null}))}),{selected:r,totalFalaises:a,filteredFalaises:o,itinerairesColors:f,selectedType:i,isFalaiseSelected:v,isGareSelected:u,hasFiltersApplied:_,setSelected:x,clearSelected:y,updateStats:p,getColorForIndex:c}}),q={key:0,class:"flex gap-1 items-center justify-center font-bold text-primary border-b border-base-300 pb-1 mb-1"},A={key:0},j={key:1},z={key:1,class:"flex flex-col gap-1 items-center text-center"},O={key:2,class:"flex flex-col gap-1"},R={class:"flex flex-col md:flex-row justify-between items-center gap-4"},J={class:"text-xl font-bold"},K=["href"],Q=["href"],U=["innerHTML"],W=["innerHTML"],X={key:0},Y={key:3,class:"flex flex-col gap-1"},Z={class:"text-xl font-bold"},ee=["href"],le=D({__name:"InfoPanel",setup(r){const a=I(),o=d(()=>a.selected),f=d(()=>a.isFalaiseSelected),i=d(()=>a.isGareSelected),v=d(()=>a.hasFiltersApplied),u=d(()=>f.value?o.value:null),_=d(()=>i.value?o.value:null);function x(p){return a.getColorForIndex(p)}function y(p){return p?p.replace(/\n/g,"<br>"):""}return(p,c)=>(t(),s("div",null,[o.value?k("",!0):(t(),s("div",q,[G(P,{name:"filter",class:"w-4 h-4"}),v.value?(t(),s("span",A,n(m(a).filteredFalaises)+" falaises correspondent aux filtres ",1)):(t(),s("span",j,n(m(a).totalFalaises)+" falaises ",1))])),o.value?u.value?(t(),s("div",O,[l("div",R,[l("h3",J,[l("a",{href:`/falaise.php?falaise_id=${u.value.falaise_id}`},n(u.value.falaise_nom),9,K)]),l("a",{class:"btn btn-primary btn-xs text-base-100! hover:text-base-100!",href:`/falaise.php?falaise_id=${u.value.falaise_id}`}," Voir la fiche falaise ",8,Q)]),u.value.falaise_fermee?(t(),s("p",{key:0,class:"text-wrap text-error",innerHTML:y(u.value.falaise_fermee)},null,8,U)):(t(),s("p",{key:1,class:"text-wrap",innerHTML:y(u.value.falaise_voletcarto)},null,8,W)),l("details",null,[c[1]||(c[1]=l("summary",null,[l("i",null,"Liste des accès")],-1)),l("ul",null,[(t(!0),s(S,null,C(u.value.access,(e,h)=>{var g;return t(),s("li",{key:e.velo_id,class:"relative ml-8"},[l("div",{class:E(["absolute top-[6px] -left-2 w-6 h-1 -translate-x-full",x(h)])},null,2),l("div",null,[l("b",null,n((g=e.gare)==null?void 0:g.gare_nom)+" ("+n(m(L)(m(T)(e)))+")",1),w(" : "+n(e.velo_km)+" km, "+n(e.velo_dplus)+" D+ ",1),e.velo_apieduniquement==="1"?(t(),s("span",X," (à pied)")):k("",!0)])])}),128))])])])):_.value?(t(),s("div",Y,[l("h3",Z,"Gare de "+n(_.value.gare_nom),1),l("details",null,[c[3]||(c[3]=l("summary",null,[l("i",null,"Falaises accessibles depuis la gare")],-1)),l("ul",null,[(t(!0),s(S,null,C(_.value.access,(e,h)=>{var g,F;return t(),s("li",{key:e.velo_id,class:"relative ml-8"},[l("div",{class:E(["absolute top-2 -left-2 w-6 h-1 -translate-x-full",x(h)])},null,2),l("div",null,[l("a",{class:"link",href:`/falaise.php?falaise_id=${(g=e.falaise)==null?void 0:g.falaise_id}`},n((F=e.falaise)==null?void 0:F.falaise_nom),9,ee),c[2]||(c[2]=w(" : ",-1)),l("b",null,n(m(L)(m(T)(e))),1),w(" "+n(e.velo_apieduniquement==="1"?"à pied":"à vélo")+" ("+n(e.velo_km)+" km, "+n(e.velo_dplus)+" D+). ",1)])])}),128))])])])):k("",!0):(t(),s("div",z,[...c[0]||(c[0]=[l("div",null,"Cliquez sur une falaise pour voir ses informations",-1)])]))]))}}),ae=$(le,[["__scopeId","data-v-35c4dc8c"]]);function V(){const r=document.getElementById("vue-info-panel");if(!r){console.warn("[velogrimpe] #vue-info-panel mount point not found");return}const a=M(ae),o=N();a.use(o);const f=I(o);window.velogrimpe=window.velogrimpe||{},window.velogrimpe.carteInfo={setSelected:i=>{f.setSelected(i)},clearSelected:()=>{f.clearSelected()},updateStats:(i,v)=>{f.updateStats(i,v)}},a.mount(r),console.log("[velogrimpe] Vue info panel mounted"),window.dispatchEvent(new CustomEvent("velogrimpe:info-ready"))}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",V):V();
