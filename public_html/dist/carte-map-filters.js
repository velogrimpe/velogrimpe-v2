import{d as J,r as F,f as m,c as n,o as i,a as e,n as r,u as o,i as y,F as f,b as x,t as g,e as N,m as k,k as L}from"./chunks/runtime-dom.esm-bundler-DMen96Nq.js";import{c as q}from"./chunks/pinia-CZ5zk4qe.js";import{u as H}from"./chunks/filters-CmDp-o8g.js";import{_ as V}from"./chunks/Icon.vue_vue_type_script_setup_true_lang-C9j0lfjA.js";import{_ as K}from"./chunks/SearchAutocomplete.vue_vue_type_script_setup_true_lang-Dz_hQzl_.js";import{_ as U}from"./chunks/_plugin-vue_export-helper-DlAUqK2U.js";import"./chunks/Autocomplete.vue_vue_type_script_setup_true_lang-XJhyqp0n.js";const Q={class:"leaflet-filters-control flex flex-col gap-1"},W={class:"flex items-center gap-1 justify-end"},X={key:1,class:"filters-scroll-container"},Y={class:"flex gap-1 items-center"},Z={class:"dropdown dropdown-end w-fit shrink-0"},ee={class:"dropdown-content menu bg-base-200 rounded-box z-[1001] m-1 w-56 p-2 shadow-lg",tabindex:"1"},te={class:"flex flex-col gap-2"},se=["value"],le=["value"],oe={class:"dropdown dropdown-end w-fit shrink-0"},ne={class:"dropdown-content menu gap-1 bg-base-200 rounded-box z-[1001] m-1 w-64 p-2 shadow-lg",tabindex:"1"},ie={class:"flex flex-col gap-2"},ae={class:"flex flex-col gap-3"},re={class:"flex flex-col gap-1"},de=["checked","onChange"],ue={class:"label-text"},pe={class:"label cursor-pointer gap-2 p-0 pr-1 w-full justify-start"},be=["value"],ce=["value"],me={class:"grid grid-cols-[auto_auto] gap-x-2 gap-y-1 w-full"},ve={class:"label hover:bg-base-300 rounded-lg cursor-pointer gap-2 p-0 pr-1 w-full justify-start"},fe=["checked","onChange"],xe={class:"label-text"},ge={class:"dropdown dropdown-end w-fit shrink-0"},he={class:"dropdown-content menu bg-base-200 rounded-box z-[1001] m-1 w-40 p-2 shadow-lg",tabindex:"1"},we={class:"flex flex-row gap-1 items-center"},ye={class:"max-w-96 flex flex-col gap-1 w-full"},_e=["checked","onChange"],ke={class:"label-text"},Ve={class:"text-xs text-slate-400"},Ce={class:"dropdown w-fit dropdown-end shrink-0"},Te=["title"],Me={key:0,class:"dropdown-content menu bg-base-200 rounded-box z-[1001] m-1 w-64 p-2 shadow-lg",tabindex:"1"},Fe={class:"flex flex-row gap-2 items-center"},Ne=["value"],Se={class:"flex flex-row items-center gap-1 mt-2"},Ee={class:"flex flex-row gap-2 items-center"},Oe={class:"label cursor-pointer gap-1"},Ie=["checked"],Pe={class:"label cursor-pointer gap-1"},$e=["checked"],Ae={class:"form-control cursor-pointer"},ze={class:"label gap-2 p-0 justify-start"},je=["checked"],De={class:"dropdown w-fit dropdown-end shrink-0"},Be={class:"dropdown-content menu bg-base-200 rounded-box z-[1001] m-1 w-64 p-2 shadow-lg",tabindex:"1"},Re={class:"flex flex-row gap-3 items-center"},Ge={class:"flex flex-col gap-1"},Je={class:"flex flex-row gap-2 flex-wrap items-center"},Le=["value"],qe={class:"flex flex-row gap-2 items-center"},He=["value"],Ke={class:"flex flex-row gap-2 items-center"},Ue=["value"],Qe={class:"flex flex-row gap-2 items-center mt-2"},We={class:"flex flex-row gap-2 items-center hover:bg-base-300 rounded-lg cursor-pointer p-0 pr-1"},Xe=["checked"],Ye={class:"dropdown w-fit dropdown-end shrink-0"},Ze={class:"dropdown-content menu bg-base-200 rounded-box z-[1001] m-1 w-56 p-2 shadow-lg",tabindex:"1"},et={class:"flex flex-row gap-2 items-center"},tt=["value"],st={class:"dropdown w-fit dropdown-end shrink-0"},lt=["title"],ot={key:0,class:"dropdown-content menu bg-base-200 rounded-box z-[1001] m-1 p-2 shadow-lg",tabindex:"1"},nt={class:"flex flex-col gap-2 items-end"},it={class:"flex flex-row gap-1 items-center"},at=["value"],rt={class:"flex flex-row gap-1 items-center"},dt=["value"],ut=["disabled"],pt={class:"flex items-center gap-1 justify-end"},bt={key:1,class:"flex items-center gap-1 bg-base-100 rounded-lg shadow-md p-1"},ct={class:"flex-1 min-w-48"},mt=J({__name:"CarteMapFilters",props:{falaises:{},gares:{},villes:{}},setup(d){const u=d,s=H(),p=F(!1);function w(){p.value=!0}function _(){p.value=!1}const h=F(!1);function E(){h.value=!0}function C(){h.value=!1}function O(c){C()}const I=[{id:"N",label:"Nord",hint:"(NO, N, NE)"},{id:"E",label:"Est",hint:"(NE, E, SE)"},{id:"S",label:"Sud",hint:"(SE, S, SO)"},{id:"O",label:"Ouest",hint:"(SO, O, NO)"}],P=[[{id:"40",label:"4 et -"}],[{id:"50",label:"5-"},{id:"59",label:"5+"}],[{id:"60",label:"6-"},{id:"69",label:"6+"}],[{id:"70",label:"7-"},{id:"79",label:"7+"}],[{id:"80",label:"8 et +"}]],$=[{id:"couenne",label:"Couenne"},{id:"grandeVoie",label:"Grandes voies"},{id:"bloc",label:"Bloc"},{id:"psychobloc",label:"Psychobloc"}],A=[{value:0,label:"Pas de minimum"},{value:20,label:"Plus de 20"},{value:50,label:"Plus de 50"},{value:100,label:"Plus de 100"},{value:200,label:"Plus de 200"}],z=m(()=>s.filters.exposition.length>0),j=m(()=>s.filters.cotations.length>0||s.filters.typeVoies.couenne||s.filters.typeVoies.grandeVoie||s.filters.typeVoies.bloc||s.filters.typeVoies.psychobloc||s.filters.nbVoiesMin>0),T=m(()=>s.filters.train.tempsMax!==null||s.filters.train.correspMax!==null||s.filters.train.terOnly),D=m(()=>s.filters.velo.tempsMax!==null||s.filters.velo.distMax!==null||s.filters.velo.denivMax!==null||s.filters.velo.apiedPossible),B=m(()=>s.filters.approche.tempsMax!==null),M=m(()=>s.filters.total.tempsTV!==null||s.filters.total.tempsTVA!==null),a=m(()=>s.filters.villeId!==null);function R(c){return s.filters.exposition.includes(c)}function G(c){return s.filters.cotations.includes(c)}function b(c){const t=parseInt(c,10);return isNaN(t)?null:t}return(c,t)=>(i(),n("div",Q,[e("div",W,[p.value?(i(),n("div",X,[e("div",Y,[e("div",Z,[e("div",{tabindex:"0",role:"button",class:r(["btn btn-sm text-nowrap focus:pointer-events-none shadow-md border-0",a.value?"btn-primary":"bg-base-100"])}," Ville ðŸ™ï¸ ",2),e("div",ee,[e("div",te,[t[16]||(t[16]=e("div",{class:"font-bold"},"Ville de dÃ©part",-1)),e("select",{class:"select select-sm border-base-300 focus:outline-base-300 w-full",value:o(s).filters.villeId??"",onChange:t[0]||(t[0]=l=>o(s).setVilleId(l.target.value||null))},[t[15]||(t[15]=e("option",{value:""},"Toutes les villes",-1)),(i(!0),n(f,null,x(u.villes,l=>(i(),n("option",{key:l.ville_id,value:l.ville_id},g(l.ville_nom),9,le))),128))],40,se)])])]),e("div",oe,[e("div",{tabindex:"0",role:"button",class:r(["btn btn-sm text-nowrap focus:pointer-events-none shadow-md border-0",j.value?"btn-primary":"bg-base-100"])}," Voies ðŸ§—â€â™€ï¸ ",2),e("div",ne,[e("div",ie,[e("div",ae,[t[18]||(t[18]=e("div",null,[e("span",{class:"font-bold"},"Cotations"),N(" (ex: 5+ ET 6+)")],-1)),e("div",re,[(i(),n(f,null,x(P,l=>e("div",{key:l[0].id,class:"flex flex-row gap-4"},[(i(!0),n(f,null,x(l,v=>(i(),n("label",{key:v.id,class:r(["label hover:bg-base-300 rounded-lg cursor-pointer gap-2 p-0 pr-1",{"w-16 justify-start":l.length>1}])},[e("input",{type:"checkbox",checked:G(v.id),class:"checkbox checkbox-primary checkbox-sm",onChange:ft=>o(s).toggleCotation(v.id)},null,40,de),e("span",ue,g(v.label),1)],2))),128))])),64)),t[17]||(t[17]=e("span",{class:"italic text-base-300 text-sm"},"(5- = de 5a Ã  5b, 5+ = de 5b+ Ã  5c+)",-1))])])]),t[19]||(t[19]=e("div",{class:"font-bold"},"Nombre de voies",-1)),e("div",null,[e("label",pe,[e("select",{class:"select border-base-300 select-sm focus:outline-base-300",value:o(s).filters.nbVoiesMin,onChange:t[1]||(t[1]=l=>o(s).setNbVoiesMin(Number(l.target.value)))},[(i(),n(f,null,x(A,l=>e("option",{key:l.value,value:l.value},g(l.label),9,ce)),64))],40,be)])]),t[20]||(t[20]=e("div",{class:"font-bold"},"Types de voies",-1)),e("div",me,[(i(),n(f,null,x($,l=>e("div",{key:l.id,class:"flex flex-row gap-2 items-center w-full"},[e("label",ve,[e("input",{type:"checkbox",checked:o(s).filters.typeVoies[l.id],class:"checkbox checkbox-primary checkbox-sm",onChange:v=>o(s).setTypeVoie(l.id,!o(s).filters.typeVoies[l.id])},null,40,fe),e("span",xe,g(l.label),1)])])),64))])])]),e("div",ge,[e("div",{tabindex:"0",role:"button",class:r(["btn btn-sm text-nowrap focus:pointer-events-none shadow-md border-0",z.value?"btn-primary":"bg-base-100"])}," Exposition ðŸ”… ",2),e("div",he,[e("div",we,[e("div",ye,[(i(),n(f,null,x(I,l=>e("label",{key:l.id,class:"label hover:bg-base-300 rounded-lg cursor-pointer gap-2 p-0 pr-1 w-full justify-start"},[e("input",{type:"checkbox",checked:R(l.id),class:"checkbox checkbox-primary checkbox-sm",onChange:v=>o(s).toggleExposition(l.id)},null,40,_e),e("span",ke,[N(g(l.label)+" ",1),e("span",Ve,g(l.hint),1)])])),64))])])])]),e("div",Ce,[e("div",{tabindex:"0",role:"button",class:r(["btn btn-sm text-nowrap focus:pointer-events-none shadow-md border-0",{"btn-primary":T.value,"bg-base-100":!T.value&&a.value,"bg-base-200 opacity-50":!a.value}]),title:a.value?"Filtrer par train":"SÃ©lectionnez une ville pour filtrer par train"}," Train ðŸšž ",10,Te),a.value?(i(),n("div",Me,[e("label",Fe,[t[21]||(t[21]=e("div",{class:"font-bold"},"DurÃ©e",-1)),t[22]||(t[22]=e("div",{class:"text-normal font-bold"},"â‰¤",-1)),e("input",{type:"number",step:"1",min:"0",class:"input input-sm w-14",value:o(s).filters.train.tempsMax??"",onInput:t[2]||(t[2]=l=>o(s).setTrainTempsMax(b(l.target.value)))},null,40,Ne),t[23]||(t[23]=e("div",null,"minutes",-1))]),e("div",Se,[t[26]||(t[26]=e("div",null,"Nb. Corresp. Max",-1)),e("div",Ee,[e("label",Oe,[e("input",{type:"radio",name:"nbCorrespMax",value:"0",class:"radio radio-primary radio-xs",checked:o(s).filters.train.correspMax===0,onChange:t[3]||(t[3]=l=>o(s).setTrainCorrespMax(0))},null,40,Ie),t[24]||(t[24]=e("span",{class:"label-text"},"0",-1))]),e("label",Pe,[e("input",{type:"radio",name:"nbCorrespMax",value:"1",class:"radio radio-primary radio-xs",checked:o(s).filters.train.correspMax===1,onChange:t[4]||(t[4]=l=>o(s).setTrainCorrespMax(1))},null,40,$e),t[25]||(t[25]=e("span",{class:"label-text"},"â‰¤1",-1))]),o(s).filters.train.correspMax!==null?(i(),n("button",{key:0,type:"button",class:"btn btn-ghost btn-xs p-0",title:"RÃ©initialiser",onClick:t[5]||(t[5]=l=>o(s).setTrainCorrespMax(null))}," âœ• ")):k("",!0)])]),t[29]||(t[29]=e("div",{class:"divider my-1"},null,-1)),e("label",Ae,[e("div",ze,[t[27]||(t[27]=e("span",{class:"label-text text-sm"},"TGV OK",-1)),e("input",{type:"checkbox",class:"toggle toggle-primary toggle-sm",checked:o(s).filters.train.terOnly,onChange:t[6]||(t[6]=l=>o(s).setTrainTerOnly(!o(s).filters.train.terOnly))},null,40,je),t[28]||(t[28]=e("span",{class:"label-text text-sm"},"TER uniquement",-1))])])])):k("",!0)]),e("div",De,[e("div",{tabindex:"0",role:"button",class:r(["btn btn-sm text-nowrap focus:pointer-events-none shadow-md border-0",D.value?"btn-primary":"bg-base-100"])}," VÃ©lo ðŸš² ",2),e("div",Be,[e("div",Re,[t[36]||(t[36]=e("div",null,"Trajet vÃ©lo",-1)),e("div",Ge,[e("label",Je,[t[30]||(t[30]=e("div",{class:"text-normal font-bold"},"â‰¤",-1)),e("input",{type:"number",step:"1",min:"0",class:"input input-sm w-14",value:o(s).filters.velo.tempsMax??"",onInput:t[7]||(t[7]=l=>o(s).setVeloTempsMax(b(l.target.value)))},null,40,Le),t[31]||(t[31]=e("div",null,"minutes",-1))]),e("label",qe,[t[32]||(t[32]=e("div",{class:"text-normal font-bold"},"â‰¤",-1)),e("input",{type:"number",step:"1",min:"0",class:"input input-sm w-14",value:o(s).filters.velo.distMax??"",onInput:t[8]||(t[8]=l=>o(s).setVeloDistMax(b(l.target.value)))},null,40,He),t[33]||(t[33]=e("div",null,"km",-1))]),e("label",Ke,[t[34]||(t[34]=e("div",{class:"text-normal font-bold"},"â‰¤",-1)),e("input",{type:"number",step:"1",min:"0",class:"input input-sm w-14",value:o(s).filters.velo.denivMax??"",onInput:t[9]||(t[9]=l=>o(s).setVeloDenivMax(b(l.target.value)))},null,40,Ue),t[35]||(t[35]=e("div",null,"D+",-1))])])]),e("div",Qe,[t[38]||(t[38]=e("div",{class:"bg-base-100 rounded-full w-6 h-6 border-2 border-base-300 flex items-center justify-center text-xs text-slate-600 font-bold"}," OU ",-1)),e("label",We,[e("input",{type:"checkbox",checked:o(s).filters.velo.apiedPossible,class:"checkbox border-base-300 bg-base-100",onChange:t[10]||(t[10]=l=>o(s).setVeloApiedPossible(!o(s).filters.velo.apiedPossible))},null,40,Xe),t[37]||(t[37]=e("div",null,"Accessible Ã  pied",-1))])])])]),e("div",Ye,[e("div",{tabindex:"0",role:"button",class:r(["btn btn-sm text-nowrap focus:pointer-events-none shadow-md border-0",B.value?"btn-primary":"bg-base-100"])}," Marche ðŸ¥¾ ",2),e("div",Ze,[e("label",et,[t[39]||(t[39]=e("div",{class:"font-bold"},"Approche",-1)),t[40]||(t[40]=e("div",{class:"text-normal font-bold"},"â‰¤",-1)),e("input",{type:"number",step:"1",min:"0",class:"input input-sm w-14",value:o(s).filters.approche.tempsMax??"",onInput:t[11]||(t[11]=l=>o(s).setApprocheTempsMax(b(l.target.value)))},null,40,tt),t[41]||(t[41]=e("div",null,"minutes",-1))])])]),e("div",st,[e("div",{tabindex:"0",role:"button",class:r(["btn btn-sm text-nowrap focus:pointer-events-none shadow-md border-0",{"btn-primary":M.value,"bg-base-100":!M.value&&a.value,"bg-base-200 opacity-50":!a.value}]),title:a.value?"Filtrer par temps total":"SÃ©lectionnez une ville pour filtrer par temps total"}," Total â±ï¸ ",10,lt),a.value?(i(),n("div",ot,[e("div",nt,[e("label",it,[t[42]||(t[42]=e("div",null,"Train+VÃ©lo",-1)),t[43]||(t[43]=e("div",{class:"text-normal font-bold"},"â‰¤",-1)),e("input",{type:"number",step:"1",min:"0",class:"input input-sm w-14",value:o(s).filters.total.tempsTV??"",onInput:t[12]||(t[12]=l=>o(s).setTotalTempsTV(b(l.target.value)))},null,40,at),t[44]||(t[44]=e("div",null,"minutes",-1))]),e("label",rt,[t[45]||(t[45]=e("div",null,"Train+VÃ©lo+Approche",-1)),t[46]||(t[46]=e("div",{class:"text-normal font-bold"},"â‰¤",-1)),e("input",{type:"number",step:"1",min:"0",class:"input input-sm w-14",value:o(s).filters.total.tempsTVA??"",onInput:t[13]||(t[13]=l=>o(s).setTotalTempsTVA(b(l.target.value)))},null,40,dt),t[47]||(t[47]=e("div",null,"minutes",-1))])])])):k("",!0)]),e("button",{type:"button",class:"btn btn-sm bg-base-100 shadow-md border-0 shrink-0",disabled:!o(s).hasActiveFilters,title:"RÃ©initialiser les filtres",onClick:t[14]||(t[14]=l=>o(s).resetFilters())},[y(V,{name:"refresh",class:"w-3 h-3"})],8,ut),e("button",{type:"button",class:"btn btn-sm bg-base-100 shadow-md border-0 shrink-0",title:"Fermer les filtres",onClick:_}," âœ• ")])])):(i(),n("button",{key:0,type:"button",class:r(["btn btn-sm shadow-md border-0",o(s).hasActiveFilters?"btn-primary":"bg-base-100"]),title:"Filtrer les falaises",onClick:w},[y(V,{name:"filter",class:"w-4 h-4"})],2))]),e("div",pt,[h.value?(i(),n("div",bt,[e("div",ct,[y(K,{falaises:u.falaises,gares:u.gares,onSelect:O},null,8,["falaises","gares"])]),e("button",{type:"button",class:"btn btn-xs btn-ghost",title:"Fermer la recherche",onClick:C}," âœ• ")])):(i(),n("button",{key:0,type:"button",class:"btn btn-sm bg-base-100 shadow-md border-0",title:"Rechercher une falaise ou une gare",onClick:E},[y(V,{name:"search",class:"w-4 h-4"})]))])]))}}),vt=U(mt,[["__scopeId","data-v-ffaa0d5e"]]);function S(){const d=document.getElementById("vue-map-filters");if(!d){console.warn("[velogrimpe] #vue-map-filters mount point not found");return}let u=[],s=[],p=[];try{u=JSON.parse(d.dataset.falaises||"[]"),s=JSON.parse(d.dataset.gares||"[]"),p=JSON.parse(d.dataset.villes||"[]"),console.log(`[velogrimpe] Parsed data: ${u.length} falaises, ${s.length} gares, ${p.length} villes`)}catch(h){console.error("[velogrimpe] Failed to parse data from PHP:",h)}const w=L(vt,{falaises:u,gares:s,villes:p}),_=q();w.use(_),w.mount(d),console.log("[velogrimpe] Vue map filters app mounted")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",S):setTimeout(S,0);
