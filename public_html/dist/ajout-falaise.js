import{k as B,r as w,l as F,N as A}from"./chunks/runtime-dom.esm-bundler-CvJMXt7Z.js";import{_ as C}from"./chunks/FormAutocomplete.vue_vue_type_script_setup_true_lang-t-v9WMV7.js";import"./chunks/Autocomplete.vue_vue_type_script_setup_true_lang-B-Tf6Nrb.js";document.addEventListener("DOMContentLoaded",()=>{const n=document.getElementById("vue-ajout-falaise");if(!n){console.warn("[velogrimpe] #vue-ajout-falaise mount point not found");return}let d=[],u=!1,c=null;try{d=JSON.parse(n.dataset.falaises||"[]"),u=n.dataset.admin==="true",c=n.dataset.presetFalaiseId?parseInt(n.dataset.presetFalaiseId,10):null}catch(t){console.error("[velogrimpe] Failed to parse ajout-falaise data:",t)}const p=t=>t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"").substring(0,255),g=t=>{typeof window.fetchAndPrefillData=="function"&&window.fetchAndPrefillData(t)};B({setup(){const t=w(""),v=w(c!==null);c&&(v.value=!0);const _=(a,f)=>{var h,I,L;const l=document.getElementById("confirmButton"),i=document.getElementById("falaiseExistsAlert"),s=document.getElementById("falaiseEditInfo"),m=document.getElementById("falaise_id"),r=document.getElementById("falaise_nomformate"),o=document.getElementById("falaise_latlng"),E=document.getElementById("linkSelectedFalaise");if(l&&(l.textContent="Ajouter la falaise"),!f){i&&i.classList.add("hidden"),s&&s.classList.add("hidden");return}const e=d.find(y=>y.nom.toLowerCase()===f.toLowerCase());e?((h=document.getElementById("falaise_img1_preview"))==null||h.classList.add("hidden"),(I=document.getElementById("falaise_img2_preview"))==null||I.classList.add("hidden"),(L=document.getElementById("falaise_img3_preview"))==null||L.classList.add("hidden"),o&&e.latlng&&(o.value=e.latlng),r&&e.nomformate&&(r.value=e.nomformate),o==null||o.dispatchEvent(new Event("input")),e.status==="verrouillÃ©e"?(i&&i.classList.remove("hidden"),s&&s.classList.add("hidden"),E&&(E.href=`/falaise.php?falaise_id=${e.id}`),u&&g(e.id)):(i&&i.classList.add("hidden"),s&&s.classList.remove("hidden"),m&&(m.value=String(e.id)),g(e.id))):(i&&i.classList.add("hidden"),s&&s.classList.add("hidden"),r&&(r.value=p(f)),m&&(m.value=""))};return F(t,a=>{if(!d.find(l=>l.nom.toLowerCase()===a.toLowerCase())){const l=document.getElementById("falaise_nomformate");l&&(l.value=p(a))}}),()=>A(C,{modelValue:t.value,"onUpdate:modelValue":a=>{t.value=a},items:d.map(a=>({...a,nom:a.nom})),acceptNewValue:!0,disabled:v.value,onSelect:_})}}).mount(n),console.log("[velogrimpe] Vue ajout-falaise autocomplete mounted")});
